<link rel="import" href="./components/polymer/polymer.html">
<link rel="import" href="./components/iron-form/iron-form.html">
<link rel="import" href="./components/paper-button/paper-button.html">
<link rel="import" href="./components/paper-input/paper-input.html">
<dom-module id="user-login">
<style>
#spacer {
  min-height: 6.6em;
  height:13%;
  width: 95%;
}
.redBackGround{
    background-color: red;
     transition: background-color 300ms linear;
}
.whiteBackgroundColor{
    background-color: white;
    transition: background-color 300ms linear;
}
</style>
<template>
    <div id="spacer"></div>
    <form is="iron-form" method="get" action="/userRouting/login" on-iron-form-response="handleResponse">
        <paper-input id="userNameInput" class$="{{changeBackground}}" name="userName" label="user name"></paper-input>
        <paper-input  name="password" class$="{{changeBackground}}" label="password"></paper-input>
        <paper-button raised on-tap="_submit">Login</paper-button>
    </form>
</template>

<script>
Polymer({
    is:"user-login",
    properties:{
        changeBackground:{
            type:String,
            value:""
        }
    },
    _submit:function(){
        Polymer.dom(event).localTarget.parentElement.submit();
    },
    handleResponse:function(res){
        if(res.detail.response != null){
            localStorage.secretKey=res.detail.response._id
            window.location="/search"
        }else{
            this.changeBackground="redBackGround"
            let that = this
            setTimeout(function(){
                that.changeBackground="whiteBackgroundColor"
            },300)
        }
    }
})
</script>

</dom-module>
